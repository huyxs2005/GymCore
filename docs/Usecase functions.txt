1) GymCore scope

A. Account and Authentication
Guest
- Register
- Login (Email/Password)
- Login via Google

Authenticated User (Admin/Coach/Receptionist/Customer)
- Logout
- Forgot Password
- Change Password
- View Profile
- Edit Profile

________________________________________
B. Customer and User Management
Receptionist
- Search Customer
- View Customer membership plan

Admin
- Create Staff Account (Admin/Coach/Receptionist)
- Lock Account
- Unlock Account

________________________________________
C. Membership and Payment (PayOS redirect)
Customer
- View Membership Plan List
- View Membership Plan Detail
- Purchase Membership Plan (PayOS redirect)
- View Current Membership Status

Admin
- Create Membership Plan
- Update Membership Plan

Business rules
- 3 types: Gym Only, Day Pass (unlimited check-ins that day), Gym + Coach
- Only ONE ACTIVE membership at a time
- Renew: extend current membership from its EndDate (no downtime, PT keeps going)
- Upgrade: apply immediately (old ends today, new starts today), full price
- Day pass is active until midnight (StartDate = EndDate)
- Membership checkout channel is PayOS redirect.
- Payment method is tracked on order/payment records for audit; supported values are PAYOS and CASH (cash is used for front-desk/offline flows).
- Payment success must not force queued memberships to ACTIVE if another ACTIVE membership already exists.

________________________________________
D. Check-in and Personal Health
Customer
- Show Check-in QR Code
- View Check-in History
- Enter Height/Weight (system calculates BMI)
- View Personal Health (current height/weight/BMI stays until updated + history)
- View Coach Notes

Receptionist
- Scan Check-in QR Code
- Check Membership Validity

________________________________________
E. Coach Booking and Training Support
Customer
- Set Desired PT Schedule (weekly recurring day+slot)
- Match Coach (full match list + partial match list)
- View Coach List
- View Coach Details
- View Coach Schedule
- Request Booking Coach (recurring)
- View PT Schedule
- Cancel / Reschedule Coach Session
- Feedback Coach (rating + comment)

Coach
- Update Available Slots (weekly availability)
- View Coach Schedule
- View Customer List
- View Customer Profile
- View Training History
- Update Training Progress
- Update Notes
- View Customer Feedback
- View Average Rating

Admin
- View Coach Students
- View Customer Feedback

________________________________________
F. Product Sales and Payment
Customer
- View Product List
- View Product Detail
- Add to Cart
- Update Cart (qty/remove)
- Checkout Order on website (PayOS redirect)
- Pick up purchased products in person at the gym/front desk (no shipping delivery)
- View Purchase History
- Write Product Review (only if purchased)

Admin
- Add Product
- Update Product
- View Product Reviews

Product order rules
- Product purchase is online checkout + in-store pickup only.
- Payment methods in system: PAYOS (online checkout) and CASH (front desk/offline).
- Shipping/delivery flow is out of scope.

________________________________________
G. Promotions, Coupons, Notifications, Revenue
Customer
- View Promotion
- Save Coupon Code (claim to wallet)
- Apply Saved Coupon at checkout (Order OR Membership)
- View Notifications (badge count)

Admin
- Create Coupon Code (discount and/or bonus duration days)
- Update Coupon Code (discount and/or bonus duration days)
- Create Promotion Post
- Update Promotion Post
- View Revenue Report
- Export reports to PDF (backend feature)

Coupon rules
- Must claim first, then apply at payment
- One-time per customer per coupon (one claim, one use)
- Coupon can provide discount amount/percent and can also add bonus duration days for memberships.

Notification rules
- Membership expiry countdown notifications: 7 -> 1 days left (daily job)
- If membership expires and not renewed: cancel PT schedules (daily job) + notify

________________________________________
H. Workout and Food Info Pages plus AI Assistant
Customer
- View Workout Categories
- View Workout Detail
- View Food Categories
- View Food Detail
- Set Fitness Goals (multi-select)

Admin
- CRUD Fitness Goals
- Map Goals <-> Workouts/Foods

AI Assistant
- Recommend workouts + foods based on saved goals
- Show which goal(s) each recommendation fits
- Assist PT booking using the same matching rules

________________________________________
I. DB-Enforced Business Rules (from GymCore.txt)
Membership / Payment
- Membership plan types are strictly: GYM_ONLY, DAY_PASS, GYM_PLUS_COACH.
- Only GYM_PLUS_COACH plans can set AllowsCoachBooking = 1 (GYM_ONLY/DAY_PASS must be 0).
- DAY_PASS must have DurationDays = 1 and AllowsCoachBooking = 0.
- DAY_PASS customer memberships must have StartDate = EndDate.
- Customer membership statuses are: PENDING, SCHEDULED, ACTIVE, EXPIRED, CANCELLED.
- Only one ACTIVE membership per customer at a time.
- Only one SCHEDULED membership per customer at a time.
- Payment row must target exactly one domain: Order OR CustomerMembership (not both).
- Only one PENDING payment per order.
- Only one PENDING payment per membership.

Coach booking / PT
- Time slots are fixed 8 slots/day; each slot has valid StartTime < EndTime and index range 1..8.
- Coach weekly availability uses DayOfWeek 1..7 and IsAvailable default = 1.
- New coaches are auto-seeded with full weekly availability (7 days x 8 slots).
- PT recurring request statuses are: PENDING, APPROVED, DENIED, CANCELLED.
- A PT request must use an ACTIVE membership of the same customer, that allows coach booking, and fully covers requested StartDate..EndDate.
- One customer can have only one APPROVED PT recurring request at a time.
- Coach cannot be double-booked on same date + slot (scheduled/completed uniqueness).

Check-in
- Check-in is blocked unless membership is ACTIVE, belongs to the same customer, and check-in date is within membership StartDate..EndDate.

Promotions / claims
- One claim per user per promotion.
- Claim usage must be consistent: unused claim has no used fields; used claim must link to exactly one target (order or membership) and used payment.
- Claim source post/promotion must be active and within valid windows.

Daily job (membership lifecycle)
- Daily job sends expiry countdown notifications for ACTIVE memberships (7..1 days left).
- Daily job expires memberships whose EndDate is before today.
- Daily job activates due SCHEDULED memberships only when customer has no ACTIVE membership.
- Daily job cancels future SCHEDULED PT sessions for customers with no ACTIVE membership and notifies customer.
